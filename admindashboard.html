<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f6f9;
        }
        .navbar {
            background-color: #007BFF;
            color: white;
            padding: 10px;
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 10;
        }
        .navbar a {
            color: white;
            margin: 0 15px;
            font-weight: bold;
            text-decoration: none;
            font-size: 18px;
        }
        .navbar a:hover {
            text-decoration: underline;
        }
        .content {
            padding-bottom: 60px; /* Space for navbar */
            margin-top: 20px;
        }
        .card {
            margin: 15px;
        }
        .card-title {
            font-size: 20px;
        }
        .summary-card {
            font-size: 30px;
            font-weight: bold;
            color: #000;
        }
        .container {
            margin-top: 20px;
        }
        .footer {
            text-align: center;
            padding: 10px;
            background: #333;
            color: white;
            position: fixed;
            width: 100%;
            bottom: 0;
        }
        .card-header {
            background-color: #007BFF;
            color: white;
            font-weight: bold;
        }
        .summary-card {
            font-size: 30px;
            font-weight: bold;
            color: #333;
        }
        .table th, .table td {
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <!-- Admin Dashboard Content -->
    <div class="container content">
        <h2>Admin Dashboard</h2>

        <!-- Summary Cards -->
        <div class="row">
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="summary-card" id="totalUsers">Loading...</h5>
                        <p>Total Users</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="summary-card" id="totalDrivers">Loading...</h5>
                        <p>Total Drivers</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="summary-card" id="pendingCars">Loading...</h5>
                        <p>Pending Cars</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        <h5 class="summary-card" id="futureBookings">Loading...</h5>
                        <p>Future Bookings</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Manage Users Section -->
        <div class="row">
            <div class="col-md-12">
                <h4>Manage Users</h4>
                <div id="usersList">Loading...</div>
            </div>
        </div>

        <!-- Manage Drivers Section -->
        <div class="row">
            <div class="col-md-12">
                <h4>Manage Drivers</h4>
                <div id="driversList">Loading...</div>
            </div>
        </div>

        <!-- Manage Pending Cars Section -->
        <div class="row">
            <div class="col-md-12">
                <h4>Manage Pending Cars</h4>
                <div id="pendingCarsList">Loading...</div>
            </div>
        </div>

        <!-- Manage Slots Section -->
        <div class="row">
            <div class="col-md-12">
                <h4>Manage Slots</h4>
                <div id="slotsList">Loading...</div>
            </div>
        </div>

        <!-- Manage Bookings Section -->
        <div class="row">
            <div class="col-md-12">
                <h4>Manage Bookings</h4>
                <div id="bookingsList">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>&copy; 2025 WaveTravel. All rights reserved.</p>
    </div>

    <!-- Navbar -->
    <div class="navbar">
        <a href="admindashboard.html">Dashboard</a>
        <a href="manageusers.html">Users</a>
        <a href="managedrivers.html">Drivers</a>
        <a href="pendingcars.html">Pending Cars</a>
        <a href="slots.html">Slots</a>
        <a href="bookings.html">Bookings</a>
        <a href="profile.html">Profile</a>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDsn16p7w8b-x8pEA_WTO5F2oUk4MHwcUc",
            authDomain: "wavetravel-3c4c4.firebaseapp.com",
            databaseURL: "https://wavetravel-3c4c4-default-rtdb.firebaseio.com",
            projectId: "wavetravel-3c4c4",
            storageBucket: "wavetravel-3c4c4.firebasestorage.app",
            messagingSenderId: "298226098137",
            appId: "1:298226098137:web:720953b80e3e61c8bc43c8"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Firebase Authentication
        const auth = firebase.auth();

        // Check if the admin is logged in, if not redirect to login page
        firebase.auth().onAuthStateChanged(user => {
            if (!user || user.email !== "contactwaveride@gmail.com") {
                window.location.href = "login.html"; // Redirect to login page
            }
        });

        // Fetch total users, drivers, pending cars, and future bookings
        function fetchDashboardData() {
            db.ref('users').once('value', snapshot => {
                document.getElementById('totalUsers').innerText = snapshot.numChildren();
            });

            db.ref('driverdetails').once('value', snapshot => {
                document.getElementById('totalDrivers').innerText = snapshot.numChildren();
            });

            db.ref('pendingcarapproval').once('value', snapshot => {
                document.getElementById('pendingCars').innerText = snapshot.numChildren();
            });

            db.ref('bookings').orderByChild('date').startAt(new Date().toISOString()).once('value', snapshot => {
                document.getElementById('futureBookings').innerText = snapshot.numChildren();
            });
        }

        // Fetch users list
        function fetchUsers() {
            db.ref('users').once('value', snapshot => {
                const usersList = document.getElementById('usersList');
                usersList.innerHTML = '';
                snapshot.forEach(childSnapshot => {
                    const user = childSnapshot.val();
                    const userElement = document.createElement('div');
                    userElement.textContent = `Name: ${user.name}, Email: ${user.email}`;
                    usersList.appendChild(userElement);
                });
            });
        }

        // Fetch drivers list
        function fetchDrivers() {
            db.ref('driverdetails').once('value', snapshot => {
                const driversList = document.getElementById('driversList');
                driversList.innerHTML = '';
                snapshot.forEach(childSnapshot => {
                    const driver = childSnapshot.val();
                    const driverElement = document.createElement('div');
                    driverElement.textContent = `Name: ${driver.name}, Email: ${driver.email}`;
                    driversList.appendChild(driverElement);
                });
            });
        }

        // Fetch pending cars
        function fetchPendingCars() {
            db.ref('pendingcarapproval').once('value', snapshot => {
                const pendingCarsList = document.getElementById('pendingCarsList');
                pendingCarsList.innerHTML = '';
                snapshot.forEach(childSnapshot => {
                    const car = childSnapshot.val();
                    const carElement = document.createElement('div');
                    carElement.textContent = `Car: ${car.model}, Status: Pending`;
                    pendingCarsList.appendChild(carElement);
                });
            });
        }

        // Fetch slots
        function fetchSlots() {
            db.ref('availableslots').once('value', snapshot => {
                const slotsList = document.getElementById('slotsList');
                slotsList.innerHTML = '';
                snapshot.forEach(childSnapshot => {
                    const slot = childSnapshot.val();
                    const slotElement = document.createElement('div');
                    slotElement.textContent = `Date: ${slot.date}, Available Seats: ${slot.seats}`;
                    slotsList.appendChild(slotElement);
                });
            });
        }

        // Fetch bookings
        function fetchBookings() {
            db.ref('bookings').once('value', snapshot => {
                const bookingsList = document.getElementById('bookingsList');
                bookingsList.innerHTML = '';
                snapshot.forEach(childSnapshot => {
                    const booking = childSnapshot.val();
                    const bookingElement = document.createElement('div');
                    bookingElement.textContent = `Booking ID: ${booking.id}, Customer: ${booking.customerName}, Date: ${booking.date}`;
                    bookingsList.appendChild(bookingElement);
                });
            });
        }

        // Initialize the page
        window.onload = function() {
            fetchDashboardData();
            fetchUsers();
            fetchDrivers();
            fetchPendingCars();
            fetchSlots();
            fetchBookings();
        };
    </script>
</body>
</html>

