<!DOCTYPE html>
<html>
<head>
  <title>OTP Test</title>
  <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js"></script>
</head>
<body>
  <h2>OTP Login Test</h2>
  <input type="text" id="phone" placeholder="+91XXXXXXXXXX"><br>
  <div id="recaptcha-container"></div><br>
  <button onclick="sendOTP()">Send OTP</button>
  <br><br>
  <input type="text" id="otp" placeholder="Enter OTP"><br>
  <button onclick="verifyOTP()">Verify OTP</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDsn16p7w8b-x8pEA_WTO5F2oUk4MHwcUc",
      authDomain: "wavetravel-3c4c4.firebaseapp.com",
      projectId: "wavetravel-3c4c4",
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    window.onload = () => {
      window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
        'size': 'normal',
        'callback': (response) => {
          console.log("reCAPTCHA resolved");
        }
      });
      recaptchaVerifier.render();
    };

    function sendOTP() {
      const phoneNumber = document.getElementById('phone').value;
      const appVerifier = window.recaptchaVerifier;
      auth.signInWithPhoneNumber(phoneNumber, appVerifier)
        .then((confirmationResult) => {
          window.confirmationResult = confirmationResult;
          alert("OTP Sent");
        }).catch((error) => {
          alert(error.message);
          console.error(error);
        });
    }

    function verifyOTP() {
      const code = document.getElementById('otp').value;
      window.confirmationResult.confirm(code).then((result) => {
        alert("OTP Verified");
        console.log(result.user);
      }).catch((error) => {
        alert("Wrong OTP");
        console.error(error);
      });
    }
  </script>
</body>
</html>
